# API Entegrasyonu

Sign UI, backend API ile OpenAPI generated client Ã¼zerinden iletiÅŸim kurar.

## ğŸ¤– OpenAPI Client

### Otomatik Generated Client

Backend'in OpenAPI spesifikasyonundan otomatik olarak TypeScript client generate edilir.

```bash
# API client'Ä± yeniden generate et
curl -s http://localhost:8085/api-docs -o openapi.json
npx openapi-typescript-codegen --input ./openapi.json --output ./src/api/generated
rm openapi.json
```

### YapÄ±

```
src/api/generated/
â”œâ”€â”€ core/           # OpenAPI client core
â”œâ”€â”€ models/         # DTO type definitions
â”‚   â”œâ”€â”€ SignPadesDto.ts
â”‚   â”œâ”€â”€ SignXadesDto.ts
â”‚   â”œâ”€â”€ SignWsSecurityDto.ts
â”‚   â””â”€â”€ ...
â””â”€â”€ services/       # API service methods
    â”œâ”€â”€ PadesControllerService.ts
    â”œâ”€â”€ XadesControllerService.ts
    â””â”€â”€ ...
```

## ğŸ£ Custom Hooks

### useSignPDF

PDF imzalama hook'u.

```typescript
import { useSignPDF } from '@/hooks/use-sign'

const { mutate: signPDF, isLoading } = useSignPDF()

signPDF({
  document: file,
  appendMode: false
})
```

### useSignXML

XML imzalama hook'u.

```typescript
import { useSignXML } from '@/hooks/use-sign'

const { mutate: signXML } = useSignXML()

signXML({
  document: file,
  documentType: 'UblDocument'
})
```

### useCertificates

Sertifika listesi hook'u.

```typescript
import { useCertificates } from '@/hooks/use-certificates'

const { data: certificates, isLoading } = useCertificates()
```

### useTimestamp

Timestamp hook'u.

```typescript
import { useGetTimestamp } from '@/hooks/use-timestamp'

const { mutate: getTimestamp } = useGetTimestamp()

getTimestamp({
  document: file,
  hashAlgorithm: 'SHA256'
})
```

## âš™ï¸ API Configuration

### Base URL

`src/lib/api-config.ts`:

```typescript
export const API_BASE_URL = import.meta.env.VITE_API_BASE_URL || 'http://localhost:8085'

OpenAPI.BASE = API_BASE_URL
```

### Environment Variables

`.env`:

```bash
VITE_API_BASE_URL=http://localhost:8085
```

## ğŸ“¦ Services

### Generated Services

- `PadesControllerService` - PDF imzalama
- `XadesControllerService` - XML imzalama
- `CertificateInfoService` - Sertifika yÃ¶netimi
- `TimestampService` - Zaman damgasÄ±
- `TBTakService` - TÃœBÄ°TAK servisleri

### KullanÄ±m Ã–rneÄŸi

```typescript
import { PadesControllerService } from '@/api/generated'

const response = await PadesControllerService.signPades({
  document: file,
  appendMode: false
})
```

## ğŸ”„ React Query

State management iÃ§in TanStack Query kullanÄ±lÄ±r.

```typescript
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      refetchOnWindowFocus: false,
      retry: 1,
      staleTime: 5 * 60 * 1000
    }
  }
})
```

## ğŸ“ Type Safety

TÃ¼m API istekleri TypeScript tip gÃ¼venliÄŸi ile:

```typescript
// DTO'lar otomatik generate edilir
const signRequest: SignPadesDto = {
  document: file,
  appendMode: false
}

// Type-safe API call
const response = await PadesControllerService.signPades(signRequest)
```

## ğŸ”— Ä°lgili DÃ¶kÃ¼manlar

- [Sign API Reference](/sign-api)
- [Component Rehberi](/sign-ui/components)

